import{ObjectUtils as e,DomHandler as t}from"primevue/utils";import{FilterService as i}from"primevue/api";import l from"primevue/ripple";import o from"primevue/virtualscroller";import{resolveComponent as n,resolveDirective as s,openBlock as a,createElementBlock as r,renderSlot as p,createElementVNode as u,withDirectives as d,vModelText as h,createCommentVNode as c,normalizeStyle as m,createVNode as f,mergeProps as b,createSlots as g,withCtx as y,normalizeClass as v,Fragment as O,renderList as x,createTextVNode as S,toDisplayString as V}from"vue";var K={name:"Listbox",emits:["update:modelValue","change","filter"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,listStyle:null,disabled:Boolean,dataKey:null,multiple:Boolean,metaKeySelection:Boolean,filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},virtualScrollerOptions:{type:Object,default:null}},optionTouched:!1,virtualScroller:null,data:()=>({filterValue:null}),methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(t){return this.optionLabel?e.resolveFieldData(t,this.optionLabel):t},getOptionValue(t){return this.optionValue?e.resolveFieldData(t,this.optionValue):t},getOptionRenderKey(t){return this.dataKey?e.resolveFieldData(t,this.dataKey):this.getOptionLabel(t)},isOptionDisabled(t){return!!this.optionDisabled&&e.resolveFieldData(t,this.optionDisabled)},getOptionGroupRenderKey(t){return e.resolveFieldData(t,this.optionGroupLabel)},getOptionGroupLabel(t){return e.resolveFieldData(t,this.optionGroupLabel)},getOptionGroupChildren(t){return e.resolveFieldData(t,this.optionGroupChildren)},onOptionSelect(e,t){this.disabled||this.isOptionDisabled(t)||(this.multiple?this.onOptionSelectMultiple(e,t):this.onOptionSelectSingle(e,t),this.optionTouched=!1)},onOptionTouchEnd(){this.disabled||(this.optionTouched=!0)},onOptionSelectSingle(e,t){let i=this.isSelected(t),l=!1,o=null;if(!this.optionTouched&&this.metaKeySelection){let n=e.metaKey||e.ctrlKey;i?n&&(o=null,l=!0):(o=this.getOptionValue(t),l=!0)}else o=i?null:this.getOptionValue(t),l=!0;l&&this.updateModel(e,o)},onOptionSelectMultiple(e,t){let i=this.isSelected(t),l=!1,o=null;if(!this.optionTouched&&this.metaKeySelection){let n=e.metaKey||e.ctrlKey;i?(o=n?this.removeOption(t):[this.getOptionValue(t)],l=!0):(o=n&&this.modelValue||[],o=[...o,this.getOptionValue(t)],l=!0)}else o=i?this.removeOption(t):[...this.modelValue||[],this.getOptionValue(t)],l=!0;l&&this.updateModel(e,o)},isSelected(t){let i=!1,l=this.getOptionValue(t);if(this.multiple){if(this.modelValue)for(let t of this.modelValue)if(e.equals(t,l,this.equalityKey)){i=!0;break}}else i=e.equals(this.modelValue,l,this.equalityKey);return i},removeOption(t){return this.modelValue.filter((i=>!e.equals(i,this.getOptionValue(t),this.equalityKey)))},updateModel(e,t){this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})},onOptionKeyDown(e,t){let i=e.currentTarget;switch(e.which){case 40:var l=this.findNextItem(i);l&&l.focus(),e.preventDefault();break;case 38:var o=this.findPrevItem(i);o&&o.focus(),e.preventDefault();break;case 13:this.onOptionSelect(e,t),e.preventDefault()}},findNextItem(e){let i=e.nextElementSibling;return i?t.hasClass(i,"p-disabled")||t.hasClass(i,"p-listbox-item-group")?this.findNextItem(i):i:null},findPrevItem(e){let i=e.previousElementSibling;return i?t.hasClass(i,"p-disabled")||t.hasClass(i,"p-listbox-item-group")?this.findPrevItem(i):i:null},onFilterChange(e){this.$emit("filter",{originalEvent:e,value:e.target.value})},virtualScrollerRef(e){this.virtualScroller=e}},computed:{visibleOptions(){if(this.filterValue){if(this.optionGroupLabel){let e=[];for(let t of this.options){let l=i.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);l&&l.length&&e.push({...t,items:l})}return e}return i.filter(this.options,this.searchFields,this.filterValue,"contains",this.filterLocale)}return this.options},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},virtualScrollerDisabled(){return!this.virtualScrollerOptions}},directives:{ripple:l},components:{VirtualScroller:o}};const D={class:"p-listbox p-component"},C={key:0,class:"p-listbox-header"},L={class:"p-listbox-filter-container"},F=["placeholder"],M=u("span",{class:"p-listbox-filter-icon pi pi-search"},null,-1),T=["tabindex","onClick","onKeydown","aria-label","aria-selected"],k={class:"p-listbox-item-group"},w=["tabindex","onClick","onKeydown","aria-label","aria-selected"],G={key:2,class:"p-listbox-empty-message"},$={key:3,class:"p-listbox-empty-message"};!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var l=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===i&&l.firstChild?l.insertBefore(o,l.firstChild):l.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("\n.p-listbox-list-wrapper {\n    overflow: auto;\n}\n.p-listbox-list {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n}\n.p-listbox-item {\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.p-listbox-item-group {\n    cursor: auto;\n}\n.p-listbox-filter-container {\n    position: relative;\n}\n.p-listbox-filter-icon {\n    position: absolute;\n    top: 50%;\n    margin-top: -.5rem;\n}\n.p-listbox-filter {\n    width: 100%;\n}\n"),K.render=function(e,t,i,l,o,K){const I=n("VirtualScroller"),E=s("ripple");return a(),r("div",D,[p(e.$slots,"header",{value:i.modelValue,options:K.visibleOptions}),i.filter?(a(),r("div",C,[u("div",L,[d(u("input",{type:"text",class:"p-listbox-filter p-inputtext p-component","onUpdate:modelValue":t[0]||(t[0]=e=>o.filterValue=e),placeholder:i.filterPlaceholder,onInput:t[1]||(t[1]=(...e)=>K.onFilterChange&&K.onFilterChange(...e))},null,40,F),[[h,o.filterValue]]),M])])):c("",!0),u("div",{class:"p-listbox-list-wrapper",style:m(i.listStyle)},[f(I,b({ref:K.virtualScrollerRef},i.virtualScrollerOptions,{style:i.listStyle,items:K.visibleOptions,disabled:K.virtualScrollerDisabled}),g({content:y((({styleClass:l,contentRef:n,items:s,getItemOptions:h,contentStyle:f})=>[u("ul",{ref:n,class:v(["p-listbox-list",l]),style:m(f),role:"listbox","aria-multiselectable":"multiple"},[i.optionGroupLabel?(a(!0),r(O,{key:1},x(s,((i,l)=>(a(),r(O,{key:K.getOptionGroupRenderKey(i)},[u("li",k,[p(e.$slots,"optiongroup",{option:i,index:K.getOptionIndex(l,h)},(()=>[S(V(K.getOptionGroupLabel(i)),1)]))]),(a(!0),r(O,null,x(K.getOptionGroupChildren(i),((i,l)=>d((a(),r("li",{tabindex:K.isOptionDisabled(i)?null:"0",class:v(["p-listbox-item",{"p-highlight":K.isSelected(i),"p-disabled":K.isOptionDisabled(i)}]),key:K.getOptionRenderKey(i),onClick:e=>K.onOptionSelect(e,i),onTouchend:t[3]||(t[3]=e=>K.onOptionTouchEnd()),onKeydown:e=>K.onOptionKeyDown(e,i),role:"option","aria-label":K.getOptionLabel(i),"aria-selected":K.isSelected(i)},[p(e.$slots,"option",{option:i,index:K.getOptionIndex(l,h)},(()=>[S(V(K.getOptionLabel(i)),1)]))],42,w)),[[E]]))),128))],64)))),128)):(a(!0),r(O,{key:0},x(s,((i,l)=>d((a(),r("li",{tabindex:K.isOptionDisabled(i)?null:"0",class:v(["p-listbox-item",{"p-highlight":K.isSelected(i),"p-disabled":K.isOptionDisabled(i)}]),key:K.getOptionRenderKey(i),onClick:e=>K.onOptionSelect(e,i),onTouchend:t[2]||(t[2]=e=>K.onOptionTouchEnd()),onKeydown:e=>K.onOptionKeyDown(e,i),role:"option","aria-label":K.getOptionLabel(i),"aria-selected":K.isSelected(i)},[p(e.$slots,"option",{option:i,index:K.getOptionIndex(l,h)},(()=>[S(V(K.getOptionLabel(i)),1)]))],42,T)),[[E]]))),128)),o.filterValue&&(!s||s&&0===s.length)?(a(),r("li",G,[p(e.$slots,"emptyfilter",{},(()=>[S(V(K.emptyFilterMessageText),1)]))])):!i.options||i.options&&0===i.options.length?(a(),r("li",$,[p(e.$slots,"empty",{},(()=>[S(V(K.emptyMessageText),1)]))])):c("",!0)],6)])),_:2},[e.$slots.loader?{name:"loader",fn:y((({options:t})=>[p(e.$slots,"loader",{options:t})]))}:void 0]),1040,["style","items","disabled"])],4),p(e.$slots,"footer",{value:i.modelValue,options:K.visibleOptions})])};export{K as default};
